---
title: "Group Project"
author: "Rachel Lewis"
date: "2024-10-03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(corrplot) 
library(reshape2)
```

# Introduction

Group: Tigers
Group names: Rachel, Paul, Nathan, Adil

In this group project, we will be analyzing tele-marketing data to predict the likelihood of success for tele-marketing calls. This assignment provides an opportunity to tackle a significant business challenge, giving us hands-on experience with real-world data from a bank's telemarketing campaign. Our goal is to develop insights into why the call center is underperforming and to create predictive models to address this issue.

The dataset for this project, tele.csv, reflects a real-world scenario where approximately 90% of the telemarketing calls fail to convert. This highlights the urgent need for optimization, which we aim to explore through data analytics.

## Get Data

```{r}
#read data from csv file
calls <- read.csv("tele.csv")
```

## Clean Data

We are removing the X, duration, and pdays variables. The x variablue only counts the amount of rows, the duration variable gives data about the call that we are trying to predict, and the pdays variable gives us information that we can get from poutcome and contact variables. We also factorized all the "character" variables and turned the response variable into a binary variable. 

```{r}
#delete columns X, duration, pdays
calls$X <- NULL
calls$duration <- NULL
calls$pdays <- NULL

#factorize char variables
calls$job <- as.factor(calls$job)
calls$marital <- as.factor(calls$marital)
calls$education <- as.factor(calls$education)
calls$default <- as.factor(calls$default)
calls$housing <- as.factor(calls$housing)
calls$loan <- as.factor(calls$loan)
calls$contact <- as.factor(calls$contact)
calls$month <- as.factor(calls$month)
calls$day_of_week <- as.factor(calls$day_of_week)
calls$poutcome <- as.factor(calls$poutcome)
#make response variable binary
calls$y <- ifelse(calls$y == "no", 0, 1)

#display cleaned data
str(calls)
```
## Calculate Breakeven percentage
For the Call center to break even, the cost per call must be equal to the return per call:

$Margin Per Call * x\:=\:VariableCostPerCall+\frac{TrainingCost}{RetentionRate+BonusRetetionRate}$

$10x\:=\:1+\frac{1000}{1000+10000x}$

$x=\frac{1}{5\sqrt{2}},\:x=-\frac{1}{5\sqrt{2}}$

since we are dealing with a probability, only the positive value is possible

$x=\frac{1}{5\sqrt{2}}=0.1414$

The breakeven percentage: 14.14%

## Visualize the Data


```{r}
# 1. Summary of the data
summary(calls)

# 2. Check class distribution of the target variable 'y'
y_dist <- calls %>%
  group_by(y) %>%
  summarise(count = n()) %>%
  mutate(percentage = count / sum(count) * 100)

# Plot the class distribution
ggplot(y_dist, aes(x = factor(y), y = percentage, fill = factor(y))) +
  geom_bar(stat = "identity", width = 0.5) +
  labs(title = "Distribution of Target Variable (y)",
       x = "Outcome (0 = No, 1 = Yes)", y = "Percentage") +
  scale_fill_manual(values = c("red", "green")) +
  theme_minimal()

# 3. Visualize numeric features with respect to y
ggplot(calls, aes(x = age, fill = factor(y))) +
  geom_histogram(bins = 30, alpha = 0.6, position = "identity") +
  labs(title = "Distribution of Age by Outcome",
       x = "Age", y = "Count") +
  scale_fill_manual(values = c("red", "green"), name = "Outcome (y)") +
  theme_minimal()

# Calculate success rate by age
age_success <- calls %>%
  group_by(age) %>%
  summarise(success_rate = mean(y))  # Calculate the proportion of y = 1 for each age

# 4. Visualize success rate by age
ggplot(age_success, aes(x = age, y = success_rate)) +
  geom_line(color = "blue", size = 1) +
  geom_point(color = "darkred", size = 2) +
  labs(title = "Relative Success Rate by Age",
       x = "Age", y = "Success Rate (y = 1)") +
  theme_minimal() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1))  # Show y-axis as percentages

# 5. Visualize Job, Education, Housing status, day of the weak and Loan status vs y

# Job vs Success Rate
ggplot(calls, aes(x = job, fill = factor(y))) +
  geom_bar(position = "fill") +
  labs(title = "Proportion of Success by Job Type",
       x = "Job Type", y = "Proportion") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Education vs Success Rate
ggplot(calls, aes(x = education, fill = factor(y))) +
  geom_bar(position = "fill") +
  labs(title = "Proportion of Success by Education Level",
       x = "Education Level", y = "Proportion") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Loan Status vs Success Rate
ggplot(calls, aes(x = loan, fill = factor(y))) +
  geom_bar(position = "fill") +
  labs(title = "Impact of Loan Status on Success",
       x = "Loan Status", y = "Proportion") +
  theme_minimal()

# Housing Status vs Success Rate
ggplot(calls, aes(x = housing, fill = factor(y))) +
  geom_bar(position = "fill") +
  labs(title = "Impact of Housing Status on Success",
       x = "Housing Status", y = "Proportion") +
  theme_minimal()

# Day of the Week vs Success Rate
ggplot(calls, aes(x = day_of_week, fill = factor(y))) +
  geom_bar(position = "fill") +
  labs(title = "Success Rate by Day of the Week",
       x = "Day of the Week", y = "Proportion") +
  theme_minimal()

# 6 Calculate success rate by number of campaign contacts
contacts_success <- calls %>%
  group_by(campaign) %>%
  summarise(success_rate = mean(y))  # Calculate the proportion of y = 1 for each contact count

ggplot(contacts_success, aes(x = campaign, y = success_rate)) +
  geom_line(color = "purple", size = 1) +
  geom_point(color = "darkgreen", size = 2) +
  labs(title = "Relative Success Rate by Number of Contacts",
       x = "Number of Contacts", y = "Success Rate (y = 1)") +
  theme_minimal() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1))  # Show y-axis as percentages


# 7. Visualize the effect of month on the success rate
ggplot(calls, aes(x = month, fill = factor(y))) +
  geom_bar(position = "fill") +
  labs(title = "Success Rate by Month", x = "Month", y = "Proportion") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# 8. Analyze the impact of previous outcomes (poutcome) on y
ggplot(calls, aes(x = poutcome, fill = factor(y))) +
  geom_bar(position = "fill") +
  labs(title = "Impact of Previous Outcomes on Current Success",
       x = "Previous Outcome", y = "Proportion") +
  theme_minimal()
```

# Interpretation of visualization:

-The Target Variable y (if a call was successful) has an average of 11.27%. This means that we are below our break-even level - that is why we are not profitable.

-Looking at the distribution by age, we can see that the number of successes is highest for people around 25 and 40 years old. But in these age groups, there were also the most people called. Looking at Graph 3.1, we can see that success rate is actually lowest for these ages, the highest success rates are for people below 18 and above 60.
This goes along with the job types that are linked to the highest success rates. Students and retired people.

-There is a higher chance of success for illiterate people. That may also be people that either didn't learn how to read and write yet, or that are disabled. Looking at the summary we can deduce that the number of illiterate people must be quite low though, for it does not even appear as a listed factor there.

-We can see that loan status itself has absolutely no influence on success rates, neither has housing status.

-We can see that the call center's success rate is lower on mondays and fridays. If that has something to do with the call center's worker's work moral or with customers willingness to buy can't be determined yet.

-When looking at the graph plotting the relative success rate by number of contacts, we can quickly see that contacting people more often generally decreases the likelihood of having a successful call.

-There are differences between success rates in different months. In March, September, October and December there are  significantly higher success rates. This cannot be explained at this point,

-At last, it becomes clear that the success rate is significantly higher for people that prevoiusly bought our product. This shouldn't lead to the assumption though that we should always call the same people. Demand gets saturated and relative success diminishes with an increasing number of calls. Additionally, only a fraction of the people that got called had bought the product before. This is not a group we can heavily rely on.





